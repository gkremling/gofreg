<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>New-Models ‚Ä¢ gofreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="New-Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gofreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/gofreg.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Architecture.html">Architecture</a></li>
    <li><a class="dropdown-item" href="../articles/New-Models.html">New-Models</a></li>
    <li><a class="dropdown-item" href="../articles/New-TestStatistics.html">New-TestStatistics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gkremling/gofreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>New-Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gkremling/gofreg/blob/master/vignettes/New-Models.Rmd" class="external-link"><code>vignettes/New-Models.Rmd</code></a></small>
      <div class="d-none name"><code>New-Models.Rmd</code></div>
    </div>

    
    
<p>The package offers several models (mostly GLMs) that can be used for
parametric regression and a subsequent goodness-of-fit test. However,
there might be other models that the user wishes to use in their
analysis. In the following, we will describe how custom models can be
defined and used along with the package.</p>
<div class="section level2">
<h2 id="the-abstract-base-class-paramregrmodel">The abstract base class <code>ParamRegrModel</code><a class="anchor" aria-label="anchor" href="#the-abstract-base-class-paramregrmodel"></a>
</h2>
<p>Whenever the user wants to define a new model, they have to create an
R6 class inheriting from the abstract base class
<code>ParamRegrModel</code>. In particular, the following methods have
to be implemented:</p>
<ul>
<li>
<code>f_yx()</code> evaluating the conditional density function</li>
<li>
<code>F_yx()</code> evaluating the conditional distribution
function</li>
<li>
<code>F1_yx()</code> evaluating the conditional quantile
function</li>
<li>
<code>mean_yx()</code> evaluating the regression function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mathbb{E}[Y|X=x])</annotation></semantics></math>
</li>
<li>
<code>sample_yx()</code> generating a sample of response variables
according to the conditional distribution</li>
<li>
<code>fit()</code> handling the shape of the <code>params</code>
argument and applying the <code>fit()</code>-method of the abstract base
class</li>
</ul>
<p>It is recommended to check the correct shape of the
<code>params</code> argument in all five methods above. Usually, it is a
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> with tags corresponding to the model parameters.</p>
<p><strong>Important note:</strong> When evaluating the likelihood
function, <code>f_yx</code> (and <code>F_yx</code> as well in case of
censored data) will be called with the argument <code>params</code>
being a plain numeric vector instead of a list. This case should be
minded in the checks at the beginning of these methods.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In the following example, we will define a new model of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œº</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(Y|X) \sim \mathcal{N}(\mu(X), \sigma(X))</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œº</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mo>+</mo><msup><mi>e</mi><mrow><msup><mi>b</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mu(X) = a + e^{b^T x}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>c</mi><mi>T</mi></msup><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma(X) = c^T x^2</annotation></semantics></math>
(where the squaring is performed element-wise).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CustomModel</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  classname <span class="op">=</span> <span class="st">"CustomModel"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">ParamRegrModel</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    </span>
<span>    f_yx <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span>, <span class="va">params</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkAtomicVector.html" class="external-link">test_atomic_vector</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># reshape plain numeric vector into list with appropriate tags</span></span>
<span>        <span class="va">xcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkAtomicVector.html" class="external-link">assert_atomic_vector</a></span><span class="op">(</span><span class="va">params</span>, len <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">xcol</span><span class="op">)</span></span>
<span>        <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                       b <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                       c <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">t</span>, mean <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">mean_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span><span class="op">)</span>, </span>
<span>               sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">params</span><span class="op">$</span><span class="va">c</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    </span>
<span>    F_yx <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span>, <span class="va">params</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkAtomicVector.html" class="external-link">test_atomic_vector</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># reshape plain numeric vector into list with appropriate tags</span></span>
<span>        <span class="va">xcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkAtomicVector.html" class="external-link">assert_atomic_vector</a></span><span class="op">(</span><span class="va">params</span>, len <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">xcol</span><span class="op">)</span></span>
<span>        <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                       b <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                       c <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="va">t</span>, mean <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">mean_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span><span class="op">)</span>, </span>
<span>               sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">params</span><span class="op">$</span><span class="va">c</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    </span>
<span>    F1_yx <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x</span>, <span class="va">params</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">t</span>, mean <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">mean_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span><span class="op">)</span>, </span>
<span>               sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">params</span><span class="op">$</span><span class="va">c</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    </span>
<span>    sample_yx <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, mean <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="fu">mean_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span><span class="op">)</span>, </span>
<span>                                sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">params</span><span class="op">$</span><span class="va">c</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    </span>
<span>    mean_yx <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">params</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="va">params</span><span class="op">$</span><span class="va">a</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">params</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    </span>
<span>    fit <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">params_init</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">params</span>, <span class="va">loglik</span> <span class="op">=</span> <span class="va">loglik_xy</span>, <span class="va">inplace</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNames.html" class="external-link">assert_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, must.include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="fu">check_params</span><span class="op">(</span><span class="va">params_init</span>, <span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span>      <span class="va">params_opt</span> <span class="op">&lt;-</span> <span class="va">super</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">params_init</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>                                    loglik <span class="op">=</span> <span class="va">loglik</span><span class="op">)</span></span>
<span>      <span class="va">xcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">params_opt</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">params_opt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                        b <span class="op">=</span> <span class="va">params_opt</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                        c <span class="op">=</span> <span class="va">params_opt</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">+</span><span class="va">xcol</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">xcol</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">inplace</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params_opt</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">params_opt</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    check_params <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkList.html" class="external-link">assert_list</a></span><span class="op">(</span><span class="va">params</span>, len <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNames.html" class="external-link">assert_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, identical.to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkVector.html" class="external-link">assert_vector</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">b</span>, len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkVector.html" class="external-link">assert_vector</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">c</span>, len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, let us generate some data following this new model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">CustomModel</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">params_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.8</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">sample_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params_true</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 √ó 2</span></span></span>
<span><span class="co">#&gt;     x[,1]  [,2]     y</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.560</span>  0.239  1.73</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.230</span>  0.962  2.69</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  1.56   0.601  4.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.070<span style="text-decoration: underline;">5</span> 0.515  2.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  0.129  0.403  2.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  1.72   0.880  5.04</span></span></code></pre>
<p>Fitting the model to the generated data should yield good estimates
of the model parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, inplace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">get_params</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $a</span></span>
<span><span class="co">#&gt; [1] 0.8015445</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] 0.4956839 0.7074226</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $c</span></span>
<span><span class="co">#&gt; [1] 0.07651354 0.21522819</span></span></code></pre>
<p>Further, a goodness-of-fit test should not reject the (correct)
model, i.e. yield a rather high p-value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GOFTest.html">GOFTest</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model_fitted <span class="op">=</span> <span class="va">model</span>, test_stat <span class="op">=</span> <span class="va"><a href="../reference/CondKolmY.html">CondKolmY</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">gt</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.33</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gitte Kremling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
