<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The gofreg package: Perform goodness-of-fit tests for parametric regression • gofreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The gofreg package: Perform goodness-of-fit tests for parametric regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gofreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/gofreg.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Architecture.html">Architecture</a></li>
    <li><a class="dropdown-item" href="../articles/New-Models.html">New-Models</a></li>
    <li><a class="dropdown-item" href="../articles/New-TestStatistics.html">New-TestStatistics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gkremling/gofreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The gofreg package: Perform goodness-of-fit tests for parametric regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gkremling/gofreg/blob/master/vignettes/gofreg.Rmd" class="external-link"><code>vignettes/gofreg.Rmd</code></a></small>
      <div class="d-none name"><code>gofreg.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="typical-usage">Typical usage<a class="anchor" aria-label="anchor" href="#typical-usage"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Generate or load a dataset</li>
<li>Fit a parametric regression model to the given data</li>
<li>Compute the p-value of the fitted model using one of the available
test statistics</li>
</ol>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this example, we will fit a generalized linear model (GLM) to an
artificially created dataset. It consists of two covariates, one of them
normally and the other one uniformly distributed, and the response
variable following a classical linear model with normal
distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GLM.new.html">GLM.new</a></span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"normal"</span>, linkinv <span class="op">=</span> <span class="va">identity</span><span class="op">)</span></span>
<span><span class="va">params_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">model_true</span><span class="op">$</span><span class="fu">sample_yx</span><span class="op">(</span><span class="va">x</span>, <span class="va">params_true</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>First, we fit the correct model to the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GLM.new.html">GLM.new</a></span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"normal"</span>, linkinv <span class="op">=</span> <span class="va">identity</span><span class="op">)</span></span>
<span><span class="va">model_test</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, inplace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_test</span><span class="op">$</span><span class="fu">get_params</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $beta</span></span>
<span><span class="co">#&gt; [1] 1.950653 6.027008</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 0.9268118</span></span></code></pre>
<p>The parameters estimates are very close to the true values. To assess
whether the fitted model fits to the given data, we perform a
bootstrap-based goodness-of-fit test using the conditional Kolmogorov
test statistic for the marginal distribution of Y.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GOFTest.html">GOFTest</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model_fitted <span class="op">=</span> <span class="va">model_test</span>, </span>
<span>                  test_stat <span class="op">=</span> <span class="va"><a href="../reference/CondKolmY.html">CondKolmY</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gt</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.46</span></span></code></pre>
<p>As we would expect, the p-value is rather high, so the model is not
rejected. Next, we will fit a wrong model to the data. In particular, we
exclude the second covariate.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GLM.new.html">GLM.new</a></span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"normal"</span>, linkinv <span class="op">=</span> <span class="va">identity</span><span class="op">)</span></span>
<span><span class="va">data_miss</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">model_test</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data_miss</span>, params_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>               inplace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_test</span><span class="op">$</span><span class="fu">get_params</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $beta</span></span>
<span><span class="co">#&gt; [1] 11.68109</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 17.91058</span></span></code></pre>
<p>It can be seen that the variance was estimated to be rather high
which is reasonable as it includes the part of the variance that could
be explained when taking the second covariate into account. The
corresponding p-value is computed in the following code chunk.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GOFTest.html">GOFTest</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_miss</span>, model_fitted <span class="op">=</span> <span class="va">model_test</span>, </span>
<span>                  test_stat <span class="op">=</span> <span class="va"><a href="../reference/CondKolmY.html">CondKolmY</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gt2</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.01</span></span></code></pre>
<p>As the p-value is very low, the model hypothesis should be rejected.
So the test reveals the mistake in the model assumption. To further
investigate the discrepancy, we could look at the plots of the processes
underlying the test statistic.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt2</span><span class="op">$</span><span class="fu">plot_procs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="gofreg_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>It can be seen that the original process (red line) behaves very
differently than its bootstrap versions (gray lines). For comparison
purposes, we also plot the processes in case the correct model was
fitted.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt</span><span class="op">$</span><span class="fu">plot_procs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="gofreg_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>This time, the original process (red line) behaves very similar to
its bootstrap versions (gray lines). It does not show any more extreme
behavior.</p>
</div>
<div class="section level2">
<h2 id="parametric-regression-models">Parametric Regression Models<a class="anchor" aria-label="anchor" href="#parametric-regression-models"></a>
</h2>
<p>Here is a list of parametric regression models that are available in
the <code>gofreg</code> package:</p>
<ul>
<li>
<code>NormalGLM</code>: Generalized linear model with normal
distribution</li>
<li>
<code>GammaGLM</code>: Generalized linear model with gamma
distribution</li>
<li>
<code>ExpGLM</code>: Generalized linear model with exponential
distribution</li>
<li>
<code>WeibullGLM</code>: Generalized linear model with Weibull
distribution</li>
<li>
<code>NegBinomGLM</code>: Generalized linear model with negative
binomial distribution</li>
</ul>
<p>The package also offers the option to use other user-defined models.
For instructions on how to implement new models see
<code><a href="../articles/New-Models.html">vignette("New-Models")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h2>
<p>Here is a list of test statistics that are available in the
<code>gofreg</code> package:</p>
<ul>
<li>
<code>CondKolmXY</code>: Conditional Kolmogorov of the joint
distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math>
defined in Andrews (1997) <a href="https://doi.org/10.2307/2171880" class="external-link">doi:10.2307/2171880</a>
</li>
<li>
<code>SICM</code>: Simulated integrated conditional moment test
defined in Bierens &amp; Wang (2012) <a href="https://doi.org/10.1017/S0266466611000168" class="external-link">doi:10.1017/S0266466611000168</a>
</li>
<li>
<code>MEP</code>: Marked Empirical Process defined in Dikta &amp;
Scheer (2021) <a href="https://doi.org/10.1007/978-3-030-73480-0" class="external-link">doi:10.1007/978-3-030-73480-0</a>
</li>
<li>
<code>CondKolmY</code>: Conditional Kolmogorov of the marginal
distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
defined in Kremling &amp; Dikta (2024) <a href="https://arxiv.org/abs/2409.20262" class="external-link">arXiv:2409.20262</a>
<!-- * `CondKolmbXY`: Conditional Kolmogorov of the joint distribution of $(\beta^T X, Y)$ -->
</li>
</ul>
<p>The package also offers the option to use other user-defined test
statistics. For instructions on how to implement new test statistics see
<code><a href="../articles/New-TestStatistics.html">vignette("New-TestStatistics")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="censored-data">Censored data<a class="anchor" aria-label="anchor" href="#censored-data"></a>
</h2>
<p>The package can also be used to fit parametric regression models and
perform goodness-of-fit tests for randomly right-censored survival times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
In this case, the <code>loglik</code> and <code>resample</code>
arguments in the <code>ParamRegrModel$fit()</code> and
<code>GOFTest$new()</code> methods have to be specified. Moreover, the
<code>data</code> object needs to be a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> with
tags “x”, “z” and “delta” with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
representing the covariates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z = \min(Y, C)</annotation></semantics></math>
the censored times and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><msub><mn>1</mn><mrow><mo stretchy="false" form="prefix">{</mo><mi>Y</mi><mo>≤</mo><mi>C</mi><mo stretchy="false" form="postfix">}</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\delta = 1_{\{Y \le C\}}</annotation></semantics></math>
the censoring indicators. A test statistic for the censored setting is
given by <code>CondKolmY_RCM</code>.</p>
<p>Here is an example with artificial data generated from a normal GLM
with normally distributed censoring times.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/NormalGLM.html">NormalGLM</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">sample_yx</span><span class="op">(</span><span class="va">x</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">c</span><span class="op">)</span>, delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">y</span> <span class="op">&lt;=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, inplace <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          loglik <span class="op">=</span> <span class="va">loglik_xzd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="fu">get_params</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $beta</span></span>
<span><span class="co">#&gt; [1] 2.090486 2.867202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 0.965581</span></span></code></pre>
<p>It can be seen that the estimated parameters are close to the true
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta = (2,3)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma = 1</annotation></semantics></math>.
Now, we compute the corresponding p-value using the Conditional
Kolmogorov test statistic for the marginal distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
under random censorship.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GOFTest.html">GOFTest</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>, model_fitted <span class="op">=</span> <span class="va">model</span>, test_stat <span class="op">=</span> <span class="va"><a href="../reference/CondKolmY_RCM.html">CondKolmY_RCM</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  nboot <span class="op">=</span> <span class="fl">100</span>, resample <span class="op">=</span> <span class="va">resample_param_cens</span>, loglik <span class="op">=</span> <span class="va">loglik_xzd</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gt</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.46</span></span></code></pre>
<p>The p-value is rather high and the model is not rejected which is
expected since we fitted the correct model.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gitte Kremling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
