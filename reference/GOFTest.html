<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Goodness-of-fit test for parametric regression — GOFTest • gofreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Goodness-of-fit test for parametric regression — GOFTest"><meta name="description" content="This class implements functions to calculate the test statistic
for the original data as well as the statistics for bootstrap samples. It
also offers the possibility to compute the corresponding bootstrap
p-value."><meta property="og:description" content="This class implements functions to calculate the test statistic
for the original data as well as the statistics for bootstrap samples. It
also offers the possibility to compute the corresponding bootstrap
p-value."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gofreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gofreg.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Architecture.html">Architecture</a></li>
    <li><a class="dropdown-item" href="../articles/New-Models.html">New-Models</a></li>
    <li><a class="dropdown-item" href="../articles/New-TestStatistics.html">New-TestStatistics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gkremling/gofreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Goodness-of-fit test for parametric regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/gkremling/gofreg/blob/master/R/GOFTest.R" class="external-link"><code>R/GOFTest.R</code></a></small>
      <div class="d-none name"><code>GOFTest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This class implements functions to calculate the test statistic
for the original data as well as the statistics for bootstrap samples. It
also offers the possibility to compute the corresponding bootstrap
p-value.</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-GOFTest-new"><code>GOFTest$new()</code></a></p></li>
<li><p><a href="#method-GOFTest-get_stat_orig"><code>GOFTest$get_stat_orig()</code></a></p></li>
<li><p><a href="#method-GOFTest-get_stats_boot"><code>GOFTest$get_stats_boot()</code></a></p></li>
<li><p><a href="#method-GOFTest-get_pvalue"><code>GOFTest$get_pvalue()</code></a></p></li>
<li><p><a href="#method-GOFTest-plot_procs"><code>GOFTest$plot_procs()</code></a></p></li>
<li><p><a href="#method-GOFTest-clone"><code>GOFTest$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-GOFTest-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialize an instance of class GOFTest.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/GOFTest.html">GOFTest</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">model_fitted</span>,</span>
<span>  <span class="va">test_stat</span>,</span>
<span>  <span class="va">nboot</span>,</span>
<span>  resample <span class="op">=</span> <span class="va">resample_param</span>,</span>
<span>  loglik <span class="op">=</span> <span class="va">loglik_xy</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p><code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> containing the data</p></dd>


<dt><code>model_fitted</code></dt>
<dd><p>object of class <a href="ParamRegrModel.html">ParamRegrModel</a> with fitted
parameters</p></dd>


<dt><code>test_stat</code></dt>
<dd><p>object of class <a href="TestStatistic.html">TestStatistic</a></p></dd>


<dt><code>nboot</code></dt>
<dd><p>number of bootstrap iterations</p></dd>


<dt><code>resample</code></dt>
<dd><p><code>function(data, model)</code> used to resample data in
bootstrap iterations, defaults to <code><a href="resample_param.html">resample_param()</a></code></p></dd>


<dt><code>loglik</code></dt>
<dd><p><code>function(data, model, params)</code> negative log-likelihood
function used to fit model to resampled data in bootstrap iterations,
defaults to <code><a href="loglik_xy.html">loglik_xy()</a></code></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>a new instance of the class</p>
</div>

</div><p></p><hr><a id="method-GOFTest-get_stat_orig"></a><div class="section">
<h3 id="method-get-stat-orig-">Method <code>get_stat_orig()</code><a class="anchor" aria-label="anchor" href="#method-get-stat-orig-"></a></h3>
<p>Calculates the test statistic for the original data and
model.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">GOFTest</span><span class="op">$</span><span class="fu">get_stat_orig</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>object of class <a href="TestStatistic.html">TestStatistic</a></p>
</div>

</div><p></p><hr><a id="method-GOFTest-get_stats_boot"></a><div class="section">
<h3 id="method-get-stats-boot-">Method <code>get_stats_boot()</code><a class="anchor" aria-label="anchor" href="#method-get-stats-boot-"></a></h3>
<p>Calculates the test statistics for the resampled data and
corresponding models.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">GOFTest</span><span class="op">$</span><span class="fu">get_stats_boot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>vector of length <code>nboot</code> containing objects of class
<a href="TestStatistic.html">TestStatistic</a></p>
</div>

</div><p></p><hr><a id="method-GOFTest-get_pvalue"></a><div class="section">
<h3 id="method-get-pvalue-">Method <code>get_pvalue()</code><a class="anchor" aria-label="anchor" href="#method-get-pvalue-"></a></h3>
<p>Calculates the bootstrap p-value for the given model.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">GOFTest</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>p-value for the null hypothesis that <code>y</code> was generated according
to <code>model</code></p>
</div>

</div><p></p><hr><a id="method-GOFTest-plot_procs"></a><div class="section">
<h3 id="method-plot-procs-">Method <code>plot_procs()</code><a class="anchor" aria-label="anchor" href="#method-plot-procs-"></a></h3>
<p>Plots the processes underlying the bootstrap test statistics
(gray) and the original test statistic (red)</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">GOFTest</span><span class="op">$</span><span class="fu">plot_procs</span><span class="op">(</span></span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Test Statistic: %s, p-value: %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">test_stat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    <span class="va">self</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/waiver.html" class="external-link">waiver</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  color_boot <span class="op">=</span> <span class="st">"gray40"</span>,</span>
<span>  color_orig <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"plot.x"</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="st">"plot.y"</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>title</code></dt>
<dd><p>text to be displayed as title of the plot; defaults to "Test
statistic: xxx, p-value: xxx"</p></dd>


<dt><code>subtitle</code></dt>
<dd><p>text to be displayed as subtitle of the plot; default is
no subtitle</p></dd>


<dt><code>color_boot</code></dt>
<dd><p>color used to plot bootstrap test statistics; default
is "red"</p></dd>


<dt><code>color_orig</code></dt>
<dd><p>color used to plot original test statistic; default is
"gray40"</p></dd>


<dt><code>x_lab</code></dt>
<dd><p>label to use for the x-axis; default is "plot.x"</p></dd>


<dt><code>y_lab</code></dt>
<dd><p>label to use for the y-axis; default is "plot.y"</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>The object (<code>self</code>), allowing for method chaining.</p>
</div>

</div><p></p><hr><a id="method-GOFTest-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">GOFTest</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create an example dataset</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="NormalGLM.html">NormalGLM</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">sample_yx</span><span class="op">(</span><span class="va">x</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the correct model</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, inplace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the bootstrap p-value and plot the corresponding processes</span></span></span>
<span class="r-in"><span><span class="va">goftest</span> <span class="op">&lt;-</span> <span class="va">GOFTest</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, test_stat <span class="op">=</span> <span class="va"><a href="CondKolmY.html">CondKolmY</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">goftest</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6</span>
<span class="r-in"><span><span class="va">goftest</span><span class="op">$</span><span class="fu">plot_procs</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="GOFTest-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a wrong model</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="va"><a href="NormalGLM.html">NormalGLM</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>linkinv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">{</span><span class="va">u</span><span class="op">+</span><span class="fl">10</span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model2</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">data</span>, params_init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, inplace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the bootstrap p-value and plot the corresponding processes</span></span></span>
<span class="r-in"><span><span class="va">goftest2</span> <span class="op">&lt;-</span> <span class="va">GOFTest</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="va">model2</span>, test_stat <span class="op">=</span> <span class="va"><a href="CondKolmY.html">CondKolmY</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">goftest2</span><span class="op">$</span><span class="fu">get_pvalue</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span><span class="va">goftest2</span><span class="op">$</span><span class="fu">plot_procs</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="GOFTest-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gitte Kremling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

